–í–æ—Ç –¥–æ–ø–æ–ª–Ω–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π —Å–∏—Å—Ç–µ–º—ã —Å –ø–æ–ª–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º:

---

	1. trade_bot.py**
**–ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å `EnhancedTradingBot` ‚Äî —è–¥—Ä–æ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.**  
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º: –∑–∞–ø—É—Å–∫, –æ—Å—Ç–∞–Ω–æ–≤–∫–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤, –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–¥–µ–ª–æ–∫.  
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º, —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–æ–º.  
–°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π, –∑–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫.  
–¢—Ä–µ–∫–µ—Ä –ø–æ–∑–∏—Ü–∏–π (`PositionTracker`) –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –Ω–µ—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ PnL.  
–≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ –ø–æ–∑–∏—Ü–∏—è–º–∏.
ComponentsContainer.
	1.–û—Å–Ω–æ–≤–Ω—ã–µ —á–∞—Å—Ç–∏ –º–æ–¥—É–ª—è:
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ (@dataclass) –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
–ª–æ–≥–≥–µ—Ä (TradingLogger);
PositionManager;
ExchangeManager;
Strategy;
MarketAggregator;
MainBot;
ExitManager;
async_store (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –µ–¥–∏–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ BotLifecycleManager.
	2.BotLifecycleManager
–ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º:
–æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ start(), stop(), _cleanup() –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥;
—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è (BotLifecycleEvent);
—Å–æ–∑–¥–∞—ë—Ç –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ —Å–≤—è–∑—ã–≤–∞–µ—Ç –∏—Ö –º–µ–∂–¥—É —Å–æ–±–æ–π;
—É–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–º —Ü–∏–∫–ª–æ–º –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–≤–æ–π –∑–∞–¥–∞—á–µ–π;
–ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—ã SIGINT –∏ SIGTERM –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.
–í —Ä–µ–∂–∏–º–µ BACKTEST –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –±–æ—Ç–∞ –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.
	3.main()
–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:
–ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥;
—Å–æ–∑–¥–∞—ë—Ç BotLifecycleManager;
–∑–∞–ø—É—Å–∫–∞–µ—Ç start() –∏ –∂–¥—ë—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —á–µ—Ä–µ–∑ wait_for_shutdown().
	4.run_backtest_mode()
–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ –¥–ª—è –±—ç–∫—Ç–µ—Å—Ç–∞:
—Å—Ç—Ä–æ–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ backtest_setup.py;
–∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ BACKTEST;
–ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å—Ç—Ä–æ–∏—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç (PnL, win rate, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å–∏–º–≤–æ–ª–∞–º –∏ —Ç.–¥.).

2. trend_system.py**  
**–ö–ª–∞—Å—Å `HierarchicalQualityTrendSystem` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞.**  
–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑: —Ç—Ä–µ–Ω–¥ (1m) + –≤—Ö–æ–¥ (20s).  
–§–∏–ª—å—Ç—Ä—ã –∫–∞—á–µ—Å—Ç–≤–∞: –æ–±—ä—ë–º, –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å, —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫–Ω–∞.  
–í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: EMA, —Å—á—ë—Ç—á–∏–∫–∏, —Ä–µ–∂–∏–º—ã.  
–ê–Ω–∞–ª–∏–∑ —Ä—ã–Ω–æ—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–∫—É—â–∏—Ö —É—Å–ª–æ–≤–∏–π.

3. online_trend_detector.py**  
**–ö–ª–∞—Å—Å `RoleBasedOnlineTrendDetector` ‚Äî –¥–µ—Ç–µ–∫—Ç–æ—Ä —Ç—Ä–µ–Ω–¥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ CUSUM –∏ z-score.**  
–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥ —Ä–æ–ª—å ("trend" –∏–ª–∏ "entry").  
–†–∞—Å—á—ë—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏, EMA, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤.  
–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å `OnlineTrendDetector` –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.

4. multi_timeframe_confirmator.py**  

5. iqts_standards.py**  
**–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã.**  
–û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã:  
- –õ–∏—Ç–µ—Ä–∞–ª—ã (`DirectionLiteral`, `MarketRegimeLiteral` –∏ –¥—Ä.)  
- –¢–∏–ø—ã (`DetectorSignal`, `SystemStatus`, `TradeSignalIQTS`)  
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —á–µ—Ä–µ–∑ `Protocol`  
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (`TradingSystemConfig` –∏ –¥—Ä.)  
- –£—Ç–∏–ª–∏—Ç—ã: `normalize_signal`, `map_reason`, `merge_signals`, `validate_system_status`

6. ImprovedQualityTrendSystem.py**  
**–ö–ª–∞—Å—Å `ImprovedQualityTrendSystem` ‚Äî –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è.**  
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞ –∫–∞—á–µ—Å—Ç–≤–∞ (`HierarchicalQualityTrendSystem`) —Å —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–æ–º.  
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ —Å —Ä–∞—Å—á—ë—Ç–æ–º —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏, —Å—Ç–æ–ø-–ª–æ—Å—Å–∞ –∏ —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–∞.  
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–Ω–µ–≤–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π, —Å–±—Ä–æ—Å–æ–º –º–µ—Ç—Ä–∏–∫ –ø—Ä–∏ —Å–º–µ–Ω–µ –¥–Ω—è.  
–¢—Ä–µ–∫–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ —Ä–µ–∂–∏–º–∞–º —Ä—ã–Ω–∫–∞ –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º —Å–∏–≥–Ω–∞–ª–æ–≤.  
–ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å `TradingSystemInterface`.

7. risk_manager.py**  
**–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏.**  
Direction enum (BUY=1, SELL=-1, FLAT=0) ‚Äî –µ–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç.
RiskContext ‚Äî –∫–æ–Ω—Ç—Ä–∞–∫—Ç –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Ä–∏—Å–∫-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏.
EnhancedRiskManager v2.0.0 ‚Äî –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏.
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥: Direction enum –≤–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏–π.
calculate_risk_context() ‚Äî –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ SL/TP/position_size.
–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–Ω–µ–≤–Ω—ã—Ö –ø–æ—Ç–µ—Ä—å –∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤.
–ü–æ–ª–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å improved_algorithm.py —á–µ—Ä–µ–∑ legacy –º–µ—Ç–æ–¥—ã.

**–ú–ò–ì–†–ê–¶–ò–Ø –ò–ó improved_algorithm.py (2025-11-18):**
- –ü–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω EnhancedRiskManager —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏
- –î–æ–±–∞–≤–ª–µ–Ω—ã Direction enum, RiskContext, RiskLimits
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Ç—Ä–∞—Å—Å–∏—Ä—É–µ–º–æ—Å—Ç—å (validation_hash)
- improved_algorithm.py —É–¥–∞–ª—ë–Ω –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

8. enhanced_monitoring.py**  
**–ö–ª–∞—Å—Å `EnhancedMonitoringSystem` ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.**  
–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∞–Ω–∞–ª–∏–∑ –ø–æ —Ä—ã–Ω–æ—á–Ω—ã–º —Ä–µ–∂–∏–º–∞–º.  
–°–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤ —Å –ø–æ—Ä–æ–≥–æ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∏—Å–∫–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.  
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –æ—Ç—á—ë—Ç–æ–≤ –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.  
–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (Telegram, Email) —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º.  
–ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å `MonitoringInterface`.

---

üìã **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å**

–í—Å–µ –º–æ–¥—É–ª–∏ –æ–±—Ä–∞–∑—É—é—Ç **–µ–¥–∏–Ω—ã–π, —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–µ–∫**:
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è** —á–µ—Ä–µ–∑ `iqts_standards.py` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è** —á–µ—Ä–µ–∑ `online_trend_detector.py` ‚Üí `multi_timeframe_confirmator.py` ‚Üí `trend_system.py`
- **–ü–æ–ª–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞** —á–µ—Ä–µ–∑ `ImprovedQualityTrendSystem.py` —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞
- **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** —á–µ—Ä–µ–∑ `enhanced_monitoring.py`
- **–û—Å–Ω–æ–≤–Ω–æ–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä** —á–µ—Ä–µ–∑ `trade_bot.py`

